### 请问admin服务在启动的时候，报这个错org.springframework.core.env.SimpleCommandLinePropertySource cannot be cast to org.springframework.core.env.MapPropertySource。是什么原因呢，其他服务都是可以正常启动的。admin服务在本地是可以正常启动，是部署在服务器的时候报错的。

>看下启动脚本 统一使用-Dxxx=xxx的方式传参 不要用—xxx=xxx 或者移除hzero-starter-tracer依赖



###  hpfm_currency 这个表配置了数据权限(平台数据库前缀) 就会加 (SELECT * FROM hzero_platform.hpfm_currency DST__0 WHERE tenant_id = 0)  但是现在 我不需要和这个租户为0的

>只是加了平台数据库前缀吗？我们加了平台数据库前缀之后只会在表前面拼接hzero_platform的前缀，不会拼接租户Id


只加了 平台数据库前缀
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422060713106-522205969.png)


### 请问下升级1.3.1之后，swagger突然登录不上了，检查下有这个报错，该如何解决。
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422060518555-654289291.png)


>oauth服务下面加下这个参数  在bootstrap.yml文件下
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422060535507-1798080635.png)

好的！



### 想问一下文件服务这里为什么配置的时候总是提示版本不一致  修改和删除操作不行
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422060606931-951141056.png)

>你这个是什么版本的代码呀

1.2.1

>看下控制台 是不是没传objectVersionNumber？

之前我在公司这边搭建也有这个问题
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422060654673-295267610.png)

现在客户的环境又出现这个这个问题了

>直接检查redis吧，再1库 hpfm:permission下

ok


>刷新页面重新编辑保存可以么

不行
redis 也没有问题 , 这个接口是公共权限的 
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422061004521-947329308.png)


>你的问题在这条数据上  你看下数据权限  是不是维护了一条这个数据  处理一下看看
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422061023769-1257190408.png)

好的




### 这个file应该是个tinyint 这个标志 他们搭建的环境是个布尔类型 这个是哪个环节错了？  文件这里的配置
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422061138451-1096356423.png)


### 请问一下各位大神，我听说hzero是不是有了什么功能，可以检测前端用到了哪些接口，然后自动加权限？？？现在这个接口权限确实导致403的问题对我们造成了很大的困扰。

>你们是什么版本的代码？我们这边只有检测到你调用哪个接口报了403  并可以快速刷新权限的功能   叫缺失权限管理

现在是1.2的，马上要升1.3了
确实权限管理是个模块吗

>1.2版本有缺失权限管理的这个功能啊   前端页面在iam模块下

 好的，我待会去看看文档，研究下怎么用



### 请问一下，密码被锁了以后，哪个页面有解锁操作？

>子账户管理功能下解锁，如果是超级管理员锁定了，可以找回密码的方式修改，也可以直接去数据库解锁，iam_user

好的，谢谢


### 请问服务器上的后端服务启动正常，但是Euraka上一个都没注册上去，这是为什么啊？



### 请教一下，各位大佬，有没有什么方法可以获取当前用户的角色的code


### 请问下：hzero自带方式导出能实现 超链接样式吗
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422061228946-1243637849.png)

>目前不支持




### 请问下从1.2.0升到1.3.1版本，启动admin服务的时候似乎依赖包冲突了，这个大家有遇到过吗？
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422061242152-1828974249.png)

>检查下脚本 或排除hzero-starter-tracer依赖 

好的，我试下



### 这个界面能去掉吗
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422061354412-594547052.png)

> 可以在个人中心中配置不弹出
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422061408721-1052304307.png)


版本比较老 没有那个选项
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422061435998-850197660.png)

>除非改前端  我们可以给方案


### 请问工作流中缺少自带的跳转条件应该怎么解决 
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422061521139-1907738909.png)

审批方式也就一个
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422061528159-1904870537.png)



### 请问下有没有人跟e签宝做过对接



### 请问在初始化数据库的时候，使用hzero用户可以看到初始化好了的数据库了，可是在初始化期初数据的时候，一直报错说数据库不存在是什么原因呢，使用的初始化脚本是上一个之前版本的一个命令行的脚本

使用的脚本是之前1.1的这个命令行形式的
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422061616532-232016702.png)

刚发现，脚本里引用的是中划线，数据库里创建的是下划线
这个转换关系之前在1.1版本也是有的吧
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422061700538-1137409293.png)

>什么转换关系  1.1.0里面的数据脚本文件夹是下划线，你的是中划线


### 请问下工作流配置了审批规则的接口，后台方法启动就报错，前台界面启动却是正常的，这会是什么原因
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422061553603-294594715.png)

>检查参数是不是错了，对比一下参数



### 请问一下，这个功能是没有记录哪个前端菜单去调用的接口吗？
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422061426811-236088461.png)

>是的   只记录了有问题的API以及问题出现的原因

哦哦


基于已有版本升级注意事项：
由于新版本的配置文件会存在一定的调整，所以升级的时候需要使用新的配置文件！
参考文档：http://hzerodoc.saas.hand-china.com/zh/docs/release-notes/



### 再请教个问题，升级到1.3.1版本后，swagger上的认证地址有问题，这个是因为我的配置文件有问题还是什么原因导致的？
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422061800711-2068826613.png)
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422061805015-52615105.png)

>升级版本之后对比一下相应服务的配置信息，你这边遇到的问题是oauth服务的bootstrap.yml文件下面需要加一个CONTEXT的配置
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422061851325-1804602829.png)

好的，谢啦


### Hzero1.3.1先启动iam，后启动admin时，自动刷新Permission报错，请问是不是我哪里的配置有问题。
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422061832906-1522730105.png)

>异常信息再全一点

这个
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422061915625-250479802.png)




### 菜单的权限集怎么没有之前的树状结构了
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422061932824-1434009919.png)

版本:1.3.1，对比文档，缺少了新建
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422062036762-699403058.png)
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422062041117-1484105051.png)

>文档我们调整一下  现在权限集都是平级创建的

为什么改成平级创建了啊
我们有个功能是对菜单里的tab页进行控权的，在这里配置的树状权限集，这样一搞页面上配不出来了

>打平不就行了？主要考虑到多层级会增加复杂性，就去掉权限集的层级了

弄平就无法实现这样的配置了，像这样
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422062427327-2143118917.png)

这个新增按钮能不能恢复啊

>不能恢复额 你可以把权限集提上来做成平级的




### 麻烦问一下有人知道workflow-plus升级1.3.1后不在调用接口url后拼接参数的原因吗?
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422062106035-1883280225.png)

我在我自己机器上启动了一个服务 排除掉EnableChoerodonResourceServer后 用postman调用会拼接上参数
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422062205896-1205008497.png)

>什么请求类型

GET

>接口定义看一下



### 请问 服务间调用fileClient.uploadFile 的时候 文件服务报这个错 有见过吗
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422061946923-1619888314.png)



### 请问项目层级的api的应用场景一般为什么？我在平台文档里看到对于@Permission注解里level的描述主要是SITE和ORGANIZATION两种，但是网关等等配置中甚至这个Permission注解的默认level也是Project级别的，想请问一下Project级别的level一般应用于什么场景呢？

>目前平台用的是平台和租户级API，项目级API是更低的一个维度，之所以存在默认的情况，也仅仅是在不指定的时候的默认，一般public、login的api不需要指定层级，会默认是这个。使用场景主要是有项目级的情况会出现，比如猪齿鱼平台，在租户下还要分项目。
>默认了也只是字段是必输字段而已，对于public、login的api没有影响

好的，谢谢



### 有人遇到过，本地测试，服务器能ping通本地ip，但是iam_permission表没有这个接口的情况吗
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422061957660-1001064542.png)

>是本地服务的接口权限刷不到iam_permission表中吗  在系统工具下面刷新也不好使吗？

用的老版本，hzero是1.0.7版本的，没有系统工具，我去iam服务下刷一下试试，搞忘了这个功能

>哦哦   好的  刷新一下看看

刷新也不行
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422062323609-982004924.png)
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422062333156-873919078.png)

>私聊你了



### 反馈一个问题 boot-file 1.2.0.RELEASE FileRemoteService 中 文件上传使用的是 RequestPart 使用这种方式上传文件的时候 文件服务会报 修改 RequestPart 为 RequestParam可以解决这个问题
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422062623551-1237848005.png)
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422062627282-1423459160.png)

> 私聊




### 请问一下各位大佬，接口服务使用哨兵模式报redis连不上，我看端口和我设置的端口不一样，这里是什么问题
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422062706116-321391891.png)
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422062720063-1194313113.png)

接口服务配置redis哨兵模式端口和实际使用的端口不一样

>直接再配置文件加上去重新打个镜像试试

还是一样的问题

>本地行不行，本地不行那就是配错了吧。

应该不会，调度服务也是这么配置的，没有问题



### 请问一下，无论这个enableAppMultipleLogin这个值是true或者是false，移动端允许多处登录的按钮总是处于关闭状态
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422062834242-2082816077.png)



### 我想查询平台下的所有用户，这个接口需要什么权限？登录的是租户账户
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422062852950-1760195376.png)

>租户账号不可以查询平台所有用户

好的



### 我想问下，返回的数据token都是一模一样的是什么原因？所有返回的数据的token都是同一个值
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422062935172-1776266584.png)

>主键字段相同？

主键的值不同

>类定义看一下

这样的
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422063017289-943450688.png)


>Id注解没有加么

我加一下
加上了还是一样的token
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422063321409-63345615.png)

>Id是哪个包的

import javax.persistence.Id; 这个的

![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422063356884-177381214.png)

>有没有覆盖方法啊 啥的，在这里打断点看看吧org.hzero.mybatis.util.SecurityTokenUtils#generateToken

是这个嘛？
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422063529039-1767968604.png)

>是的

打了断点，但是没进来

>你们是不是覆盖了

不是吧
覆盖了哪个？ generateToken嘛？

>setToken方法

我应该把断点打在哪？才知道又没有覆盖

>数据是怎么来的 是查的数据库吧

对

>这边打断点看看  org.hzero.mybatis.security.SecurityTokenInterceptor#intercept

可以打断点 但是断点进不来
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422063709425-786763123.png)
 

>确定查的数据库？

确定呀 自定义sql语句

>那不应该数据库拦截器都不进  SQL能打印么

sql可以打印
不好意思，服务测试错了 



### 请问BigDecimal类型是不支持固定值级的吗？m.fasterxml.jackson.core.JsonParseException: Unrecognized token 'FORBIDDEN': was expecting ('true', 'false' or 'null')at [Source: (String)"FORBIDDEN"; line: 1, column: 19]会出现一个这个错误

 

### 问一下。更新方法，现在如果不传入版本号就不会校验版本信息。没有做强制校验么
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422063836132-1649828315.png)

我记得以前是可以的。昨天升级到1.3.1版本之后就不支持了。

问一下后端执行SQL报错，什么这个异常没有抛出来，直接后台服务器处理了
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422063914271-1834583375.png)

>这种一般是sql有某个数据库的方言，导致解析工具报错



### 发送短信报错
```
org.hzero.message.infra.exception.SendMessageException: {"requestId":"59275A96-4B80-4035-8BC8-F6DD35950FEB","bizId":null,"code":"isv.SMS_TEMPLATE_ILLEGAL","message":"模板不合法(不存在或被拉黑)"}
```

![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422063938836-1307361068.png)




### 请问客户端导入自定义参数格式是怎样的
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422064148312-866812509.png)

>加上花括号 ｛｝试试

加上就是400

>｛"a":2｝  ｛"a":"c"｝

这样的
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422064241131-1528965375.png)
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422064247768-795544285.png)

>检查下冒号和花括号有没有写成中文符号

没

>这样试试｛"a":"1"｝  注意中英文符号 

还是不行

>换成单引号试下
>{"aa":11}我试了，这样是可以的
>这样写aaa会报错参数错误
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422064442786-858056829.png)

>校验就通过了
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422064510997-1346086075.png)

我的是这样的
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422064540703-1661979037.png)

>应该是其他传错了

不传自定义参数就没问题  传了就400

>这里发出来 这样  curl -X POST --header 'Content-Type: multipart/form-data' --header 'Accept: application/json' --header 'Authorization: Bearer c24de18d-2969-41b6-bb93-1389999865a1' {"type":"formData"} 'http://172.28.8.102:8080/hctm/v1/0/import/data/sync/auto-import?templateCode=aaaa&param=%7B%22aa%22%3A%2011%7D'
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422064618476-87833934.png)

>这里就是要接受个字符串类型的json字符串

这样
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422064659758-1987697806.png)


>复制出来

curl -X POST --header 'Content-Type: multipart/form-data' --header 'Accept: */*' --header 'Authorization: Bearer b83ead26-168f-48ab-aacd-433c9c6a7d37' {"type":"formData"} 'http://api.srm-dev.t-brdevops.myoas.local/spuc-24959/v1/0/import/data/sync/auto-import?templateCode=SPRM.PR_LINE&param=%7B%22a%22%3A11%7D'


>templatecode测试随便输入aaa试试呢  参数的检验是最先检验的，主要试试参数能过去不

参数不带{}是能传过去的

>你这是什么版本

1.0.7  


>我的不行
![](https://img2020.cnblogs.com/blog/1231979/202004/1231979-20200422064837411-1854235367.png)


传过去就是参数格式错误啊

>肯定啦，我说了要接受json格式字符串

>私聊吧



